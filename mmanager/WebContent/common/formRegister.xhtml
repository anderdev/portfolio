<ui:composition xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        template="../template/templateAPP.xhtml" >
        	
		<ui:define name="contentAPP">
        	<h:form prependId="false" id="formRegister">
	        	<h:outputText value="#{messages['lb_credit_registration']}" styleClass="boxTitle" rendered="#{registerMBean.loadCredits}"/>
	        	<h:outputText value="#{messages['lb_debit_registration']}"  styleClass="boxTitle" rendered="#{registerMBean.loadDebits}"/>

				<p:growl id="msg" showDetail="true" showSummary="false" autoUpdate="true" sticky="true" /> 
				
				<div class="content" style="margin-top:30px">
	        		<div align="center" class="formContant">
		       	
			       		<h:panelGrid columns="2" styleClass="formCadastroUser" border="0">
		
							<h:outputText value="#{messages['lb_date']}"  />
							<p:calendar showButtonPanel="true" navigator="true" showOn="button"
								value="#{registerMBean.register.date}"  label="#{messages['lb_date_']}"
								required="true" 
								id="calendar"
								readonlyInput="false"
							    maxlength="10"
								pattern="dd/MM/yyyy"/>
							
							<h:outputText value="#{messages['lb_description']}" />
							<p:selectOneMenu value="#{registerMBean.register.description.description}"  label="#{messages['lb_description_']}" 
									required="true" style="width:100%" filter="true" filterMatchMode="startsWith" editable="true" valueChangeListener="#{registerMBean.checkCreditsDescription}">
								<p:ajax />
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.descriptions}"  var="desc" itemLabel="#{desc.description}" itemValue="#{desc}"/>
					        </p:selectOneMenu>
					        
							<!--
							<p:selectOneMenu value="#{registerMBean.register.description.description}"  label="#{messages['lb_description_']}" 
									required="true" style="width:100%" filter="true" filterMatchMode="startsWith" editable="true" valueChangeListener="#{registerMBean.checkDescription}">
								<p:ajax />
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.descriptions}"  var="desc" itemLabel="#{desc.description}" itemValue="#{desc}"/>
					            
					        </p:selectOneMenu>
					        
					        
					        <p:selectOneMenu value="#{registerMBean.register.description.id}"  label="#{messages['lb_description_']}" 
									required="true" style="width:100%" filter="true" filterMatchMode="startsWith" editable="true" >
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.descriptions}"  var="desc" itemLabel="#{desc.description}" itemValue="#{desc}"/>
					            <p:ajax event="blur" 
					            		execute="@this"
										listener="#{registerMBean.checkDescription}" 
								 		oncomplete="if(#{registerMBean.newDescription == true}){alert('eh nois!!!')}">
								</p:ajax>   
					        </p:selectOneMenu>
					         
					        <h:outputText value="#{messages['lb_description']}" />
            				
            				<p:autoComplete value="#{registerMBean.register.description}"  completeMethod="#{registerMBean.completeDescription}" converter="descriptionConverter"  
                        	   var="d" itemLabel="#{d.description}" itemValue="#{d}" dropdown="true" label="#{messages['lb_description_']}" style="width:100%" >
                        	   <p:ajax event="blur" execute="@this" listener="#{registerMBean.saveDescription}" process="@this" immediate="true" />
                        	</p:autoComplete>  
					         -->
					        
					        <h:outputText value="#{messages['lb_group']}" rendered="#{registerMBean.loadDebits}"/>
							<p:selectOneMenu value="#{registerMBean.register.group.description}" label="#{messages['lb_group_']}" 
									rendered="#{registerMBean.loadDebits}" required="true" style="width:100%" filter="true" filterMatchMode="startsWith" editable="true" valueChangeListener="#{registerMBean.checkGroupDescription}">
								<p:ajax />
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.groupItems}"  var="desc" itemLabel="#{desc.description}" itemValue="#{desc}"/>  
					        </p:selectOneMenu>
					        
					        <h:outputText value="#{messages['lb_super_group']}" />
							<p:selectOneMenu value="#{registerMBean.register.superGroup.description}" label="#{messages['lb_super_group_']}" 
									required="true" style="width:100%" filter="true" filterMatchMode="startsWith" editable="true" valueChangeListener="#{registerMBean.checkSuperGroupDescription}">
								<p:ajax />
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.superGroups}"  var="desc" itemLabel="#{desc.description}" itemValue="#{desc}"/>  
					        </p:selectOneMenu>
					        
					        <h:outputText value="#{messages['lb_creditcard']}" rendered="#{registerMBean.loadDebits}"/>
							<p:selectOneMenu value="#{registerMBean.register.creditCard.id}" label="#{messages['lb_creditcard_']}" 
									rendered="#{registerMBean.loadDebits}" style="width:100%" filter="true" filterMatchMode="startsWith">
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.creditCards}"  var="desc" itemLabel="#{desc.name}" itemValue="#{desc}"/>  
					        </p:selectOneMenu>
					        
					        <h:outputText value="#{messages['lb_type_closure']}" />
							<p:selectOneMenu value="#{registerMBean.register.typeClosure.id}" label="#{messages['lb_type_closure_']}" 
									required="true" style="width:100%" filter="true" filterMatchMode="startsWith">
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.typeClosures}"  var="desc" itemLabel="#{desc.type}" itemValue="#{desc}"/>  
					        </p:selectOneMenu>
					         
					        <h:outputText value="#{messages['lb_currency']}" />
							<p:selectOneMenu value="#{registerMBean.register.currency.id}" label="#{messages['lb_currency_']}" 
									required="true" style="width:100%" filter="true" filterMatchMode="startsWith">
					            <f:selectItem itemLabel="#{messages['lb_select']}" itemValue="" />
					            <f:selectItems value="#{registerMBean.currencies}"  var="desc" itemLabel="#{desc.acronymn}" itemValue="#{desc}"/>  
					        </p:selectOneMenu>
							
							<h:outputText value="#{messages['lb_parcels']}" />
							<p:inputText  label="#{messages['lb_parcels_']}" required="true"  value="#{registerMBean.register.numberParcel}" style="width:100%" />
							
							<h:outputText value="#{messages['lb_amount']}" />
							<p:inputText  label="#{messages['lb_amount_']}" required="true"  value="#{registerMBean.register.amount}" style="width:100%" />
						</h:panelGrid>
						
						<br />
			
						<div align="center">
							<p:commandButton value="#{messages['lb_post']}" id="post" action="#{registerMBean.save}" ajax="false" update=":formRegister" styleClass="button"/>  
							<p:commandButton value="#{messages['lb_back']}" update=":formRegister" immediate="true" id="voltar" ajax="true"  styleClass="button" action="#{registerMBean.cancel}"/>
						</div>
					</div>
					
					<div class="listContant">
						<p:dataTable var="reg" value="#{registerMBean.registerList}" style="width:100%" id="registerList"
					    		paginatorAlwaysVisible="false" paginator="true" emptyMessage="#{messages['lb_empty_list']}"
					    		rows="10" rowKey="#{reg}"	paginatorPosition="botton" >
					    	
					        <p:column sortBy="#{reg.description.description}" >
					            <f:facet name="header">
					                <h:outputText value="#{messages['lb_description_']}" />
					            </f:facet>
					            <h:outputText value="#{reg.description.description}" />
					        </p:column>
					        
					        <p:column sortBy="#{reg.date}" >
					            <f:facet name="header">
					                <h:outputText value="#{messages['lb_date_']}" />
					            </f:facet>
					            <h:outputText value="#{reg.date}">
					            	<f:convertDateTime pattern="dd/MM/yyyy" />
					            </h:outputText>
					        </p:column>
					        
					        <p:column sortBy="#{reg.amount}" >
					            <f:facet name="header">
					                <h:outputText value="#{messages['lb_amount_']}" />
					            </f:facet>
					            <h:outputText value="#{reg.amount}" />
					        </p:column>
					        
					        <p:column style="width:5%">
					        	<p:commandLink action="#{registerMBean.edit}" immediate="true" update=":formRegister" id="editButton">
					        		<f:setPropertyActionListener value="#{reg}" target="#{registerMBean.register}" />  
									<p:graphicImage value="#{messages['img_update']}" style="border: 0px" />
								</p:commandLink>
					        </p:column>
					    </p:dataTable>
					</div>
				</div>
			</h:form>
		</ui:define>
</ui:composition>
